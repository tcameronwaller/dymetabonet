%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%

% features
% This section communicates design decisions for the project.

\section{Features}

% figures

% tables

\input{table_information}

% explain network model for metabolism

The \textbf{metabolic system is a network} of relations between biological entities.
In reality, this network has multiple dimensions or layers \supercite{boccaletti_structure_2014, de_domenico_structural_2015} since there are many types of relations between many types of entities (\textbf{Table \ref{table:concept}}).
The user is familiar with a simpler model, in which \textbf{metabolites are entities, and reactions are relations between them}.
This project will use a model that is conceptually similar but is more accurate.
%This model is also conveniently compatible with the representation of the metabolic network in models from systems biology.
Rather than treating reactions as relations, this project will treat reactions as special entities since they involve the functions of multiple other entities (\textbf{Table \ref{table:concept}}).
Hence, \textbf{metabolites are entities, and reactions are entities that facilitate relations between metabolites}.
In terms of network theory, \textbf{metabolites and reactions are distinct types of nodes}, and \textbf{reactant and product metabolites have links to their respective reactions}.
This network is \textbf{sparse}, and the relations between metabolites and reactions are \textbf{many-to-many}, such that the count of links is much greater than the counts of metabolites and reactions.
This project will assume this model of metabolism and will apply principles of network and graph theory to support its study.

Multiple categories of information are relevant to this study of the metabolic network.
The \textbf{topology or connectivity} of the network describes the \textbf{metabolites that participate as reactants or products in reactions} as well as \textbf{paths across multiple reactions}.
The topology of the metabolic network is complex because \textbf{many metabolites participate in many reactions}, and \textbf{path loops are common}.
In addition, both metabolites and reactions in the metabolic network have many \textbf{properties}.
Metabolites and reactions that share the same properties belong to \textbf{sets}, such as those in the same cellular compartment.
Together, this \textbf{information about topology and properties describes the metabolic network} and is available in metabolic models from the systems biology community.
For development and demonstration of the tool, this project will use the \textbf{most recent model of general human metabolism, Recon 2.2} \supercite{thiele_community-driven_2013, swainston_recon_2016} (\textbf{Table \ref{table:model}}).
The tool will also maintain compatibility for use with metabolic models for other species, tissues, or conditions.
If the user desires, it will also be possible to supplement the properties in these models with information from databases.
Another category of information includes \textbf{attributes of entities from experimental measurements}, which are often specific to experimental conditions.
This information about attributes comes from the user.
\textbf{Table \ref{table:information}} lists these categories of information along with examples of each.

This project will develop computational methods and a tool to help the user study the metabolic network.
The tool will access information for a \textbf{model of the entire metabolic network} of the species of interest.
This model will not be comprehensive and depends on the availability of information.
Still the model describes a vast and complex network.
The tool will enable the user to \textbf{select a portion or subnetwork of interest from the model of the metabolic network}.
The tool will then \textbf{provide information to the user about this subnetwork}.
This project will apply principles of \textbf{data visualization} \supercite{gehlenborg_visualization_2010, vehlow_visual_2015, pavlopoulos_visualizing_2015} to communicate this information to the user in an \textbf{interactive, visual interface}.
Information about the topology and properties of the metabolic network will give the user context to \textbf{design experiments effectively}.
Associating information about attributes with this metabolic network will give the user context to \textbf{interpret experimental results accurately}.

%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

% specific features

%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

% selection features

\subsection{Selection Features}

The user will \textbf{select portions or subnetworks from the model of the metabolic network according to her/his interest}.
The tool will provide an \textbf{interactive, graphical interface} to help the user to assemble \textbf{queries by topology and properties}.
The tool will also assemble queries from \textbf{tables of entities with properties and attributes} that the user provides.
These tables enable the user to enrich the model with supplemental information, such as biological properties or experimental attributes.
Queries against the metabolic network will return a \textbf{list of subnetworks that satisfy the selection criteria}.
The user will then select between items in this list of subnetworks to \textbf{explore either separately or simultaneously}.
The user will also refine the selection interactively by selecting individual metabolites and reactions.
\textbf{Figures \ref{fig:2017-01-02_1} - \ref{fig:2017-01-02_2}} illustrate the design for the \textbf{Query Interface} that supports this functionality.

\begin{enumerate}

\item \textbf{Select metabolites and reactions by topology.}
\\ This type of selection depends only on the \textbf{topology} of the metabolic network around or between entities of interest.
It is independent of their properties.
The user will specify a set of entities of interest to include in or exclude from the subnetwork.
These can be metabolites or reactions, or they can be the genes, transcripts, or proteins that contribute to reactions.
As the user adds each entity to the set, the tool will suggest matching entities from the metabolic network dynamically.

Selections by topology will have the option to ignore certain categories of metabolites.
Some metabolites are extremely pervasive in metabolism and participate in many more reactions than other metabolites.
Examples include water, proton (H+), carbon dioxide, nicotinamide adenine dinucleotides (NAD+, NADH, NADP+, NADPH), flavin mononucleotides (FMN, FMNH2), and adenosine phosphates (AMP, ADP, or ATP).
Nodes for these metabolites have \textbf{very high degrees in the metabolic network, imparting excessive connectivity}.
If these metabolites are less interesting to the user, then the user can opt to ignore them in selections by topology.

\begin{itemize}

\item \textbf{Select metabolites and reactions within a specific proximity to a single entity or to multiple entities.}
\\ \textbf{Proximal selections} return all metabolites and reactions that are within a specific \textbf{path length} in all directions from a specific metabolite or reaction.
These selections to multiple entities (or to a single entity in multiple instances, such as the same protein in multiple reactions) are likely to be multiple discontinuous subnetworks.
Proximal selections give the user information about the \textbf{local context of individual metabolites and reactions}.
\\ \textbf{Example:} Select all metabolites and reactions within 1 reaction of pyruvate.
\\ \textbf{Example:} Select all metabolites and reactions within 1 reaction of gene 1, gene 2, and gene 3.

\item \textbf{Select metabolites and reactions in the shortest paths between multiple entities.}
\\ Selections by \textbf{shortest path} return all metabolites and reactions that are part of the shortest path(s) between multiple metabolites or reactions.
Shortest path selections give the user information about \textbf{how multiple metabolites or reactions relate to each other}.
\\ \textbf{Example:} Select all metabolites and reactions in the shortest path(s) between glucose and pyruvate.
\end{itemize}


\item \textbf{Select metabolites and reactions by property or attribute.}
\\ This type of selection depends only on the properties or attributes of entities in the metabolic network.
It is independent of topology.
The user will specify a set of properties to include or exclude from the subnetwork.
The tool will inform the user of the properties and attributes that are available for the metabolic network.

\begin{itemize}
\item \textbf{Include in subnetwork metabolites and reactions that have some property or attribute.}
\\ Selections by inclusion criteria include only entities that have some property or attribute.
\\ \textbf{Example:} Select all transport reactions and their metabolites.
\\ \textbf{Example:} Select all transport reactions and their metabolites between the cytoplasm compartment and the mitochondrion compartment.
\item \textbf{Exclude from subnetwork metabolites and reactions that have some property or attribute.}
\\ Selections by exclusion criteria include all entities except those that have some property or attribute.
\\ \textbf{Example:} Select all metabolites and reactions that are not in the cytoplasm compartment.

\end{itemize}

\item \textbf{Select metabolites and reactions by combinations of criteria for topology and property or attribute.}
\\ This type of selection may depend on both topology and property or attribute.
It has the most ability to select specific subnetworks.
The sequence or hierarchy of selection criteria matters.
This type of selection is appropriate to define queries from a table of entities with attributes that the user provides.
\begin{itemize}

\item \textbf{Reduce a set of entities by property or attribute before selecting metabolites and reactions by topology.}
\\ This combination of selection strategies reduces or filters a set of entities by inclusion or exclusion criteria of properties and attributes.
Then it returns metabolites and reactions by topology without further consideration of properties or attributes.
\\ \textbf{Example:} Select all metabolites and reactions that are within 1 reaction of all metabolites in the set that have a fold change greater than 1.5 and a p-value less than 0.01.
\\ \textbf{Example:} Select all metabolites and reactions that are in the shortest paths between all metabolites in the set that have a fold change greater than 1.5 and a p-value less than 0.01.
\\ \textbf{Example:} Select all metabolites and reactions that are in the shortest paths between all metabolites in the set that have a fold change greater than 1.5 and a p-value less than 0.01 and are in the mitochondrion compartment.

\item \textbf{Reduce a set of metabolites and reactions by property or attribute after selecting these metabolites and reactions by topology or by property or attribute.}
\\ This combination of selection strategies selects metabolites and reactions by topology or by property or attribute.
Then it reduces these by inclusion or exclusion criteria of properties and attributes.
\\ \textbf{Example:} Select all metabolites and reactions that are within 1 reaction of pyruvate and are in the mitochondrion compartment.
\\ \textbf{Example:} Select all reactions and their metabolites that are in the mitochondrion compartment and do not involve proteins with iron-sulfur cofactors.

\end{itemize}

\end{enumerate}

%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

% exploration features

\subsection{Exploration Features}
The user will explore information about the model of the metabolic network and the subnetwork from the selection in different ways according to her/his interest.
\textbf{Table \ref{table:information}} lists categories of information about the metabolic network.
The tool will provide an \textbf{interactive, graphical interface} to communicate this information to the user visually.
\textbf{Figures \ref{fig:2017-01-02_3} - \ref{fig:2017-01-02_10}} illustrate the design for the \textbf{Detail, Navigation, and Exploration Interfaces} that will support this functionality.

\begin{enumerate}

\item \textbf{Display summary information for the network and for the subnetwork.}
\\ Summary information orients the user to a \textbf{concise context} of both the network and the subnetwork.
It also allows the user to compare the two networks.
Multiple different types of information about the network contribute to this summary.
\textbf{Figures \ref{fig:2017-01-02_3} - \ref{fig:2017-01-02_4}} illustrate the design for the \textbf{Detail Interface} that will support this functionality.

\begin{itemize}

\item \textbf{Display basic, descriptive information about the network and the subnetwork.}
\\ This information includes the name of the model and the counts of metabolites, reactions, and compartments in both the network and the subnetwork.

\item \textbf{Display the distribution of degrees of metabolites in the network and in the subnetwork.}
\\ In a network, the degree of a node is a measure of the local relevance of the node in the network.
It is the count of links in which that node participates directly.
Every node in the network has a degree.
The distribution of degrees in a network is the proportion of nodes with each value.
This distribution conveys some idea for the connectivity of the network.

\item \textbf{Display the distribution of betweenness centralities of metabolites in the network and in the subnetwork.}
\\ In a network, the betweenness centrality of a node is a measure of the global relevance or centrality of the node in the network.
It is the count of shortest paths between all other nodes in the network that pass through the node.
Every node in the network has a betweenness centrality.
The distribution of betwenness centralities in a network is the proportion of nodes with each value.
This distribution conveys some idea for the connectivity of the network.

\item \textbf{Display the distribution of entities between sets in the network and in the subnetwork.}
\\ If multiple entities have the same property, then that property defines a set of those entities.
Any property can define a set.
Likewise the set for any property might be interesting to the user.
The distribution of entities between sets is the proportion of entities in each set or combinations of sets for a specific type of property.
This distribution conveys some idea for the structure of the network with respect to a specific property.
\\ \textbf{Example:} Display the proportion of metabolites in the network or subnetwork that occur in each compartment (cytoplasm, mitochondrion, peroxisome, etc).
\\ \textbf{Example:} Display the proportion of metabolites in the network or subnetwork that occur in each combination of multiple compartments (cytosol and mitochondrion, mitochondrion and peroxisome, etc).

\item \textbf{Display relations between sets in the network and in the subnetwork.}
\\ Sets can have relations between themselves.
These relations can be members that multiple sets share, or they can be relations between the members of separate sets.
\\ \textbf{Example:} Display the count of metabolites that occur simultaneously in the cytoplasm and mitochondrion compartments.
\\ \textbf{Example:} Display the count of transport reactions between the cytoplasm and mitochondrion compartments.

\end{itemize}

\item \textbf{Display information in detail for specific metabolites and reactions that the user selects.}
\\ There is a limit to the count of properties or attributes that the node-link diagram can represent simultaneously.
There is also a limit to the clarity of this representation on the node-link diagram.
For example, small differences in quantitative properties or attributes will not be very clear by color saturation, especially when the relevant nodes are far apart in the node-link diagram.
Also, \textbf{individual entities have properties and attributes in the context of the entire network}.
It might be most clear to represent these properties and attributes separately from the node-link diagram for the subnetwork.
The user will select individual metabolites or reactions to view their properties and attributes in more detail.
The user can select multiple metabolites or reactions to view their properties and attributes simultaneously.
\textbf{Figures \ref{fig:2017-01-02_5} - \ref{fig:2017-01-02_6}} illustrate the design for the \textbf{Detail Interface} that will support this functionality.

\begin{itemize}

\item \textbf{Represent properties and attributes of metabolites and reactions.}
\\ It will be more practical or clear to represent some properties or attributes separate from the node-link diagram.
Properties or attributes of individual entities within the entire model will be more clear in this context.
For example, it might be interesting to the user to compare the degrees or betweenness centralities of a specific metabolite in different cellular compartments.
This comparison could convey the respective relevance of the metabolite in each compartment.
\\ \textbf{Example:} Display the betweenness centralities of pyruvate in the entire metabolic network and in the subnetwork of the mitochondrion compartment.

\item \textbf{Represent properties and attributes of constituent entities.}
\\ Reactions involve the functions of multiple entities including genes, transcripts, proteins, and metabolites.
Each of these entities can have properties and attributes.
\\ \textbf{Example:} Display the fold change in abundance of a specific transcript in multiple samples.

\item \textbf{Represent relations between individual entities and other entities.}
\\ It might be useful to represent the relations between entities in a way other than the node-link diagram.
This representation might especially be useful to represent relations to individual entities in the entire model.
\\ \textbf{Example:} Display the count of reactions in which pyruvate participates along with each of its most common metabolite neighbors in the model.

\item \textbf{Display relations between individual entities and the sets to which they belong.}
\\ Relations between individual entities and multiple sets to which they belong might be interesting.
These set relations might be in the context of the entire model.
\\ \textbf{Example:} Display the count of reactions in which pyruvate participates in each cellular compartment.

\end{itemize}

\item \textbf{Represent topology of the subnetwork.}
\\ The topology of relations between entities in the metabolic network is a priority type of information, and the tool will communicate this information to the user.
\textbf{Figure \ref{fig:2017-01-02_7}} illustrates the design for the \textbf{Exploration Interface} that will support this functionality.

\begin{itemize}

\item \textbf{Represent metabolites and reactions in an explicit diagram of nodes and links.}
\\ An explicit visual diagram of nodes and links is the most appropriate representation for the metabolic subnetwork.
The versatility of this representation accommodates the complexity of the network and represents the relevant information effectively.
It provides distinct nodes and links for individual metabolites and reactions that the user can select and manipulate.
Nodes for metabolites will be boxes with labels, nodes for reactions will be arrows with labels, and links will be linear connections between nodes.
The relative positions of these nodes and links depend on their relations to each other such that the topology of the network is intuitive.
It portrays both near and distant relations between entities clearly, making path tracing intuitive and loops clear.

\item \textbf{Use an automatic and robust algorithm for the layout of the node-link diagram.}
\\ A force-directed layout is appropriate to represent the node-link diagram of the metabolic network.
This layout algorithm simulates repulsive and attractive forces between nodes and links to assign their positions and orientations in a clear layout.
This layout algorithm is sufficiently automatic and robust to accommodate many different custom selections of subnetworks from the model of the metabolic network.

\item \textbf{Support dynamic interaction with the representation of the metabolic network.}
\\ Through dynamic interaction, the user will explore the topology of the metabolic network to understand it better.
The user will select and interact with the nodes and links for individual metabolites and reactions in the diagram.
In this way it will be possible to \textbf{refine the selection from the model of the metabolic network}.
The user may choose to exclude individual metabolites or reactions from the diagram.
The user may also choose to include additional metabolites or reactions in the diagram that relate by proximity to existing metabolites or reactions.
It will also be possible to \textbf{refine the visual representation of the metabolic network in the diagram}.
Adjusting the positions of nodes and links might improve readability.
Also, nodes from some metabolites have very high degrees.
If these metabolites are less interesting to the user, the user can replicate their nodes to simplify the network and improve readability.
As \textbf{Figure \ref{fig:2017-01-02_7}} illustrates, the \textbf{Navigation Interface} also displays a list of metabolites with high degrees from which the user can control node replication.

\end{itemize}

\item \textbf{Represent properties and attributes of the metabolic network in context of the network's topology.}
\\ It will be useful to analyze properties and attributes of the metabolic network in their true context of the network's topology.
It is possible to represent some of this information directly on the node-link diagram.
This explicit representation of the metabolic network offers favorable visual channels to represent multiple types of information.
Using these visual channels, it will be possible to represent different types of information on the network diagram, keeping the information in proper context of the network's topology.
\textbf{Table \ref{table:information}} lists some examples of properties and attributes of metabolites and reactions.
Nodes of metabolites will represent properties or attributes for metabolites.
Nodes of reactions will represent properties or attributes for reactions or their constituent genes, transcripts, and proteins.
For the sake of clarity, there is a limit to the count of different types of properties and attributes that the diagram can represent simultaneously.
The user will interactively select the properties and attributes to represent on the diagram as well as how to represent them.
\textbf{Figures \ref{fig:2017-01-02_7} - \ref{fig:2017-01-02_10}} illustrate the \textbf{Navigation Interface} and the \textbf{Exploration Interface} that will support this functionality of controlling the representation of properties and attributes on the node-link diagram.

\begin{itemize}
\item \textbf{Represent categorical properties and attributes of metabolites and reactions.}
\\ Categorical properties and attributes have a nominal measurement scale.
They are discrete and are neither quantitative nor continuous.
If multiple metabolites or reactions possess the same property or attribute, then this property or attribute defines a set or group.
It is useful to recognize the metabolites and reactions that belong to each categorical set on the network diagram.
\textbf{Positional groups} of nodes and links represent these sets clearly.
\textbf{Color hue} (red, blue, green, etc) of nodes also represents these sets clearly.
\\ \textbf{Example:} Arrange nodes and links for metabolites and reactions in separate positional groups according to their compartments.
\\ \textbf{Example:} Set the colors of nodes for reactions according to their metabolic pathways.
\\ \textbf{Example:} Set the color of nodes for reactions to red if they involve the function of a protein with an iron-sulfur cluster.
\\ \textbf{Example:} Set the color of nodes for reactions to red if they transport metabolites between the cytoplasm and mitochondrion compartments.
\\ \textbf{Example:} Set the color of nodes for reactions to red if they involve the function of a transcript with a fold change in abundance greater than 1.5 and a p-value less than 0.01.

\item \textbf{Represent quantitative properties and attributes of metabolites and reactions.}
\\ Quantitative properties and attributes have either an ordinal, interval, or ratio scale.
\textbf{Color luminance or saturation} of nodes represents these properties or attributes clearly.
\\ \textbf{Example:} Set the color saturation of nodes for metabolites according to their fold change in abundance (red for increase, blue for decrease).
\\ \textbf{Example:} Set the color saturation of nodes for metabolites according to their p-value.

\end{itemize}

\end{enumerate}

%%%%%%%%%%
%%%%%%%%%%
%%%%%%%%%%

% Practical Features

\subsection{Practical Features}
These features relate to the implementation of the tool.

\begin{enumerate}

\item \textbf{Derive information from custom metabolic models.}
\\ The tool will be able to use information for \textbf{custom metabolic models}.
The metabolic system varies for different species, tissues, and conditions.
The user will need to study a model for the metabolic system of her/his interest.
The user might also want to customize the model to include additional information about entities, such as properties of proteins.
This project will maintain compatibility with the standard type and structure of information in metabolic models.
In this way the tool will accommodate custom models and revisions to existing models.

For development and demonstration, this project will use information from the most recent model of human metabolism, Recon 2.2 \supercite{thiele_community-driven_2013, swainston_recon_2016} (\textbf{Table \ref{table:model}}).
As the product of extensive community contribution, this model is publicly available and does not have a license.
The original version of Recon 2.2 is in SBML format, and is 24 Megabytes in size.
I will use libSBML \supercite{bornstein_libsbml:_2008} and COBRApy \supercite{ebrahim_cobrapy:_2013} to convert information from the model to JSON format.
In this more concise format, I estimate that the model will only be 4 Megabytes in size.
The JSON format will also be convenient for use in the JavaScript program.

In the tool, the user will choose a metabolic model to use.
I will make Recon 2.2 in JSON format available for download.
I will also provide instructions for the user to convert her/his own metabolic model to JSON format to use in the tool.

\item \textbf{Implement the tool as an entirely client-side web application.}
\\ The tool will run entirely through the client's internet browser on the client's computer.
The user will not need to install any custom programs on her/his machine.
Also, it will not be necessary to establish and maintain a server to host the tool.
The client-side web application without a server back-end will be much simpler to implement and will require much less maintenance.

The tool will access information for the metabolic model.
The model for development and demonstration in this project is Recon 2.2, which will be about 4 Megabytes in size in JSON format.
Including this information as part of the web application would require it to download every time the user refreshes her/his browser.
If the metabolic model is too large then it will cause the browser to refresh slowly.
If necessary, then I will include a smaller subset of the metabolic network from Recon 2.2 as a demonstration model that comes with the web application.
I will allow the user to download the complete Recon 2.2 model in JSON format to her/his computer.
Then the user will select whether to run the tool using the model in the web application or a model (including her/his own custom models) from her/his computer.

\end{enumerate}